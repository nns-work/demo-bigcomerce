{"version":3,"file":"theme-bundle.chunk.888.js","mappings":"uWAM+D,IAE1CA,EAAI,SAAAC,GACrB,SAAAD,EAAYE,GAAS,IAAAC,EAE0C,OAD3DA,EAAAF,EAAAG,KAAA,KAAMF,IAAQ,MACTG,mBAAqB,iCAAiCF,CAC/D,C,UAACF,G,EAAAD,G,sEAAA,IAAAM,EAAAN,EAAAO,UAsLA,OAtLAD,EAEDE,wBAAA,SAAwBC,GAAY,IAAAC,EAAA,KAC1BC,EAAaC,EAAAA,EAEnBC,KAAKC,gBAAiBC,EAAAA,EAAAA,GAAI,CACtBC,OAAQ,qCAGZH,KAAKC,eAAeG,IAAI,CACpB,CACIC,SAAU,wCACVC,SAAU,SAACC,EAAIC,GAGXD,EAFeT,EAAWW,MAAMD,GAGpC,EACAE,aAAcV,KAAKX,QAAQsB,eAE/B,CACIN,SAAU,uCACVC,SAAU,SAACC,EAAIC,GAGXD,EAFeT,EAAWc,SAASJ,GAGvC,EACAE,aAAcV,KAAKX,QAAQwB,aAInCjB,EAAWkB,GAAG,SAAU,SAAAC,GACpBlB,EAAKI,eAAee,eAEhBnB,EAAKI,eAAegB,OAAO,UAI/BF,EAAMG,gBACV,EACJ,EAACzB,EAED0B,iCAAA,SAAiCC,GAAqB,IAAAC,EAAA,KAClDrB,KAAKsB,yBAA0BpB,EAAAA,EAAAA,GAAI,CAC/BC,OAAQ,+CAGZH,KAAKsB,wBAAwBlB,IAAI,CAC7B,CACIC,SAAU,4CACVC,SAAU,SAACC,EAAIC,GAGXD,EAFeR,EAAAA,EAAMU,MAAMD,GAG/B,EACAE,aAAcV,KAAKX,QAAQsB,iBAInCS,EAAoBN,GAAG,SAAU,SAAAC,GAC7BM,EAAKC,wBAAwBN,eAEzBK,EAAKC,wBAAwBL,OAAO,UAIxCF,EAAMG,gBACV,EACJ,EAACzB,EAED8B,8BAAA,WACI,IAAMC,EAAkB,qBAClBC,GAAuBvB,EAAAA,EAAAA,GAAI,CAC7BC,OAAQuB,IAAKF,EAAe,2BAE1BG,EAAmBD,IAAKF,EAAe,2BACvCI,EAAoBF,IAAKF,EAAe,mCAE9CK,EAAAA,GAAWC,sBACPL,EACAE,EACAC,EACA5B,KAAK+B,qBAEb,EAACtC,EAEDuC,+BAAA,SAA+BC,GAC3B,IAeQC,EAfFC,GAAkBC,EAAAA,EAAAA,GAAWH,GAC7BI,GAAyBnC,EAAAA,EAAAA,GAAI,CAC/BC,OAAWH,KAAKR,mBAAkB,0BAEhC8C,EAAgBZ,IAAE,6BAClBa,EAAmBvC,KAAKR,mBAAkB,oCAC1CgD,EAAgBd,IAAEa,GAClBZ,EAAsB3B,KAAKR,mBAAkB,gCAC7CiD,EAAmBf,IAAEC,GACrBC,EAAuB5B,KAAKR,mBAAkB,uCAC9CkD,EAAoBhB,IAAEE,GAE5BS,EAAuBjC,IAAI+B,GAEvBG,IAIAK,EAAAA,EAAAA,GAAaL,EAAetC,KAAKX,QAAS,SAACuD,EAAKC,GAC5C,GAAID,EACA,MAAM,IAAIE,MAAMF,GAGpB,IAAMG,EAASrB,IAAEmB,GAEuC,cAApDR,EAAuBW,UAAUV,IACjCD,EAAuBY,OAAOX,GAG9BJ,GACAG,EAAuBY,OAAOf,GAG9Ba,EAAOG,GAAG,WACVhB,EAAQW,EACRhB,EAAAA,GAAWsB,0BAA0Bd,EAAwBQ,IAE7DhB,EAAAA,GAAWuB,uBAAuBP,EAE1C,GAGAL,IACAH,EAAuBY,OAAOV,GAC9BV,EAAAA,GAAWwB,mBAAmBhB,EAAwBE,IAGtDE,GAAoBC,IACpBL,EAAuBY,OAAOtB,GAC9BU,EAAuBY,OAAOrB,GAC9BC,EAAAA,GAAWC,sBACPO,EACAV,EACAC,EACA5B,KAAK+B,uBAIbE,EAAmBnB,GAAG,SAAU,SAAAC,GAC5BsB,EAAuBrB,eAEnBqB,EAAuBpB,OAAO,UAIlCF,EAAMG,gBACV,EACJ,EAEAzB,EAGA6D,QAAA,WACI,IAAMrB,GAAqBsB,EAAAA,EAAAA,IAAavD,KAAKR,oBACvCI,GAAa2D,EAAAA,EAAAA,IAAa,eAC1BnC,GAAsBmC,EAAAA,EAAAA,IAAa,yBACnCC,GAAmBD,EAAAA,EAAAA,IAAa,sBAGtCvD,KAAK+B,qBAAuB/B,KAAKX,QAAQ0C,qBAErCnC,EAAW6D,QACXzD,KAAKL,wBAAwBC,GAG7B4D,EAAiBC,QACjBzD,KAAKuB,gCAGLH,EAAoBqC,QACpBzD,KAAKmB,iCAAiCC,GAGtCa,EAAmBwB,QACnBzD,KAAKgC,+BAA+BC,EAE5C,EAAC9C,CAAA,CA1LoB,CAASuE,EAAAA,E,2DCyHnB,SAAS,EAACC,GACrB,IAAIC,EAAuB,GAM3B,OAJAD,EAAME,KAAK,qBAAqBC,KAAK,SAACC,EAAOC,GACzCJ,EAAuBA,EAAqBK,OAzCpD,SAAyBC,GACrB,IAAM9B,EAAa8B,EAAqBC,KAAK,cACvCC,EAAmB,GACnBC,EAAoB,IAAIH,EAAqBI,KAAK,MAExD,GAAwB,gBAApBlC,EAAWmC,KAAwB,CACnC,IAAMC,EA1Fd,SAA6BC,EAAYrC,GAErC,GAAIA,EAAWsC,UAAYtC,EAAWuC,SAAU,CAC5C,IAAMC,EAAiB,sCAAsCxC,EAAWsC,SAAQ,QAAQtC,EAAWuC,SAAQ,IACrGE,EAAgBJ,EAAWH,KAAK,MAChCQ,EAAW1C,EAAWsC,SAASK,MAAM,KACrCC,EAAW5C,EAAWuC,SAASI,MAAM,KACrCE,EAAU,IAAIC,KAAKJ,EAAS,GAAIA,EAAS,GAAK,EAAGA,EAAS,IAC1DK,EAAU,IAAID,KAAKF,EAAS,GAAIA,EAAS,GAAK,EAAGA,EAAS,IAEhE,MAAO,CACH3E,SAAU,IAAIwE,EAAa,6BAC3BO,YAAa,IAAIP,EAAa,mCAC9BvE,SAAU,SAACC,EAAIC,GACX,IAAM6E,EAAMC,OAAOb,EAAWZ,KAAK,4BAA4BrD,OACzD+E,EAAQD,OAAOb,EAAWZ,KAAK,8BAA8BrD,OAAS,EACtEgF,EAAOF,OAAO9E,GACdiF,EAAa,IAAIP,KAAKM,EAAMD,EAAOF,GAEzC9E,EAAGkF,GAAcR,GAAWQ,GAAcN,EAC9C,EACAzE,aAAckE,EAEtB,CACJ,CAkE+Bc,CAAoBxB,EAAsB9B,GAE7DoC,GACAJ,EAAiBuB,KAAKnB,EAE9B,MAAWpC,EAAWwD,UAAiC,mBAApBxD,EAAWmC,MAAiD,gBAApBnC,EAAWmC,KAGlFL,EAAqBL,KAAK,2BAA2BC,KAAK,SAACC,EAAO8B,GAC9D,IAAMC,EAAgBpE,IAAEmE,GAClBE,EAAUD,EAAcE,IAAI,GAAGD,QAC/BE,EAAYH,EAAcxB,KAAK,QAC/B4B,EAAqB7B,EAAiB,IAAI0B,EAAO,UAAUE,EAAS,KAElD,eAApB7D,EAAWmC,MACXH,EAAiBuB,KAtCjC,SAAoCvD,EAAYiC,GAC5C,IAAMO,EAAiB,iBAAiBxC,EAAW+D,MAAK,oBAAoB/D,EAAWgE,IAAG,QAAQhE,EAAWiE,IAAG,IAC1GD,EAAMd,OAAOlD,EAAWgE,KACxBC,EAAMf,OAAOlD,EAAWiE,KAE9B,MAAO,CACHhG,SAAagE,EAAiB,gBAAgBjC,EAAWkE,KAAI,KAC7DhG,SAAU,SAACC,EAAIC,GACX,IAAM+F,EAAYjB,OAAO9E,GAEzBD,EAAGgG,GAAaH,GAAOG,GAAaF,EACxC,EACA3F,aAAckE,EAEtB,CAwBsC4B,CAA2BpE,EAAYiC,IAE7DjC,EAAWwD,UACXxB,EAAiBuB,KAnDjC,SAAiCvD,EAAY/B,GACzC,MAAO,CACHA,SAAAA,EACAC,SAAQ,SAACC,EAAIC,GACTD,EAAGC,EAAIiD,OAAS,EACpB,EACA/C,aAAc,QAAQ0B,EAAW+D,MAAK,2BAE9C,CA2CsCM,CAAwBrE,EAAY8D,GAElE,GAdA9B,EAAiBuB,KAhEzB,SAAyClB,EAAYrC,GACjD,IAAMsE,EAAcjC,EAAWH,KAAK,MAE9BqC,EAAoB,IAAID,EAAW,SAEzC,MAAO,CACHrG,SAJoB,IAAIqG,EAAW,uBAKnCtB,YAAauB,EACbrG,SAAU,SAACC,GACP,IAAIqG,GAAS,EAEblF,IAAEiF,GAAmB7C,KAAK,SAACC,EAAO8C,GAC9B,GAAIA,EAASC,QAGT,OAFAF,GAAS,GAEF,CAEf,GAEArG,EAAGqG,EACP,EACAlG,aAAc,QAAQ0B,EAAW+D,MAAK,2BAE9C,CAyC8BY,CAAgC7C,EAAsB9B,IAiBhF,OAAOgC,CACX,CAW2D4C,CAAgBtF,IAAEsC,IACzE,GAEOJ,CACX,C","sources":["webpack://second-skin-audio/./assets/js/theme/auth.js","webpack://second-skin-audio/./assets/js/theme/common/form-validation.js"],"sourcesContent":["import PageManager from './page-manager';\nimport stateCountry from './common/state-country';\nimport $ from 'jquery';\nimport nod from './common/nod';\nimport validation from './common/form-validation';\nimport forms from './common/models/forms';\nimport { classifyForm, Validators } from './common/form-utils';\n\nexport default class Auth extends PageManager {\n    constructor(context) {\n        super(context);\n        this.formCreateSelector = 'form[data-create-account-form]';\n    }\n\n    registerLoginValidation($loginForm) {\n        const loginModel = forms;\n\n        this.loginValidator = nod({\n            submit: '.login-form input[type=\"submit\"]',\n        });\n\n        this.loginValidator.add([\n            {\n                selector: '.login-form input[name=\"login_email\"]',\n                validate: (cb, val) => {\n                    const result = loginModel.email(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.useValidEmail,\n            },\n            {\n                selector: '.login-form input[name=\"login_pass\"]',\n                validate: (cb, val) => {\n                    const result = loginModel.password(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.enterPass,\n            },\n        ]);\n\n        $loginForm.on('submit', event => {\n            this.loginValidator.performCheck();\n\n            if (this.loginValidator.areAll('valid')) {\n                return;\n            }\n\n            event.preventDefault();\n        });\n    }\n\n    registerForgotPasswordValidation($forgotPasswordForm) {\n        this.forgotPasswordValidator = nod({\n            submit: '.forgot-password-form input[type=\"submit\"]',\n        });\n\n        this.forgotPasswordValidator.add([\n            {\n                selector: '.forgot-password-form input[name=\"email\"]',\n                validate: (cb, val) => {\n                    const result = forms.email(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.useValidEmail,\n            },\n        ]);\n\n        $forgotPasswordForm.on('submit', event => {\n            this.forgotPasswordValidator.performCheck();\n\n            if (this.forgotPasswordValidator.areAll('valid')) {\n                return;\n            }\n\n            event.preventDefault();\n        });\n    }\n\n    registerNewPasswordValidation() {\n        const newPasswordForm = '.new-password-form';\n        const newPasswordValidator = nod({\n            submit: $(`${newPasswordForm} input[type=\"submit\"]`),\n        });\n        const passwordSelector = $(`${newPasswordForm} input[name=\"password\"]`);\n        const password2Selector = $(`${newPasswordForm} input[name=\"password_confirm\"]`);\n\n        Validators.setPasswordValidation(\n            newPasswordValidator,\n            passwordSelector,\n            password2Selector,\n            this.passwordRequirements,\n        );\n    }\n\n    registerCreateAccountValidator($createAccountForm) {\n        const validationModel = validation($createAccountForm);\n        const createAccountValidator = nod({\n            submit: `${this.formCreateSelector} input[type='submit']`,\n        });\n        const $stateElement = $('[data-field-type=\"State\"]');\n        const emailSelector = `${this.formCreateSelector} [data-field-type='EmailAddress']`;\n        const $emailElement = $(emailSelector);\n        const passwordSelector = `${this.formCreateSelector} [data-field-type='Password']`;\n        const $passwordElement = $(passwordSelector);\n        const password2Selector = `${this.formCreateSelector} [data-field-type='ConfirmPassword']`;\n        const $password2Element = $(password2Selector);\n\n        createAccountValidator.add(validationModel);\n\n        if ($stateElement) {\n            let $last;\n\n            // Requests the states for a country with AJAX\n            stateCountry($stateElement, this.context, (err, field) => {\n                if (err) {\n                    throw new Error(err);\n                }\n\n                const $field = $(field);\n\n                if (createAccountValidator.getStatus($stateElement) !== 'undefined') {\n                    createAccountValidator.remove($stateElement);\n                }\n\n                if ($last) {\n                    createAccountValidator.remove($last);\n                }\n\n                if ($field.is('select')) {\n                    $last = field;\n                    Validators.setStateCountryValidation(createAccountValidator, field);\n                } else {\n                    Validators.cleanUpStateValidation(field);\n                }\n            });\n        }\n\n        if ($emailElement) {\n            createAccountValidator.remove(emailSelector);\n            Validators.setEmailValidation(createAccountValidator, emailSelector);\n        }\n\n        if ($passwordElement && $password2Element) {\n            createAccountValidator.remove(passwordSelector);\n            createAccountValidator.remove(password2Selector);\n            Validators.setPasswordValidation(\n                createAccountValidator,\n                passwordSelector,\n                password2Selector,\n                this.passwordRequirements,\n            );\n        }\n\n        $createAccountForm.on('submit', event => {\n            createAccountValidator.performCheck();\n\n            if (createAccountValidator.areAll('valid')) {\n                return;\n            }\n\n            event.preventDefault();\n        });\n    }\n\n    /**\n     * Request is made in this function to the remote endpoint and pulls back the states for country.\n     */\n    onReady() {\n        const $createAccountForm = classifyForm(this.formCreateSelector);\n        const $loginForm = classifyForm('.login-form');\n        const $forgotPasswordForm = classifyForm('.forgot-password-form');\n        const $newPasswordForm = classifyForm('.new-password-form'); // reset password\n\n        // Injected via auth.html\n        this.passwordRequirements = this.context.passwordRequirements;\n\n        if ($loginForm.length) {\n            this.registerLoginValidation($loginForm);\n        }\n\n        if ($newPasswordForm.length) {\n            this.registerNewPasswordValidation();\n        }\n\n        if ($forgotPasswordForm.length) {\n            this.registerForgotPasswordValidation($forgotPasswordForm);\n        }\n\n        if ($createAccountForm.length) {\n            this.registerCreateAccountValidator($createAccountForm);\n        }\n    }\n}\n","import $ from 'jquery';\n\n/**\n * Validate that the given date for the day/month/year select inputs is within potential range\n * @param $formField\n * @param validation\n * @returns {{selector: string, triggeredBy: string, validate: Function, errorMessage: string}}\n */\nfunction buildDateValidation($formField, validation) {\n    // No date range restriction, skip\n    if (validation.min_date && validation.max_date) {\n        const invalidMessage = `Your chosen date must fall between ${validation.min_date} and ${validation.max_date}.`;\n        const formElementId = $formField.attr('id');\n        const minSplit = validation.min_date.split('-');\n        const maxSplit = validation.max_date.split('-');\n        const minDate = new Date(minSplit[0], minSplit[1] - 1, minSplit[2]);\n        const maxDate = new Date(maxSplit[0], maxSplit[1] - 1, maxSplit[2]);\n\n        return {\n            selector: `#${formElementId} select[data-label=\"year\"]`,\n            triggeredBy: `#${formElementId} select:not([data-label=\"year\"])`,\n            validate: (cb, val) => {\n                const day = Number($formField.find('select[data-label=\"day\"]').val());\n                const month = Number($formField.find('select[data-label=\"month\"]').val()) - 1;\n                const year = Number(val);\n                const chosenDate = new Date(year, month, day);\n\n                cb(chosenDate >= minDate && chosenDate <= maxDate);\n            },\n            errorMessage: invalidMessage,\n        };\n    }\n}\n\n/**\n * We validate checkboxes separately from single input fields, as they must have at least one checked option\n * from many different inputs\n * @param $formField\n * @param validation\n */\nfunction buildRequiredCheckboxValidation($formField, validation) {\n    const formFieldId = $formField.attr('id');\n    const primarySelector = `#${formFieldId} input:first-of-type`;\n    const secondarySelector = `#${formFieldId} input`;\n\n    return {\n        selector: primarySelector,\n        triggeredBy: secondarySelector,\n        validate: (cb) => {\n            let result = false;\n\n            $(secondarySelector).each((index, checkbox) => {\n                if (checkbox.checked) {\n                    result = true;\n\n                    return false;\n                }\n            });\n\n            cb(result);\n        },\n        errorMessage: `The '${validation.label}' field cannot be blank.`,\n    };\n}\n\nfunction buildRequiredValidation(validation, selector) {\n    return {\n        selector,\n        validate(cb, val) {\n            cb(val.length > 0);\n        },\n        errorMessage: `The '${validation.label}' field cannot be blank.`,\n    };\n}\n\nfunction buildNumberRangeValidation(validation, formFieldSelector) {\n    const invalidMessage = `The value for ${validation.label} must be between ${validation.min} and ${validation.max}.`;\n    const min = Number(validation.min);\n    const max = Number(validation.max);\n\n    return {\n        selector: `${formFieldSelector} input[name=\"${validation.name}\"]`,\n        validate: (cb, val) => {\n            const numberVal = Number(val);\n\n            cb(numberVal >= min && numberVal <= max);\n        },\n        errorMessage: invalidMessage,\n    };\n}\n\n\nfunction buildValidation($validateableElement) {\n    const validation = $validateableElement.data('validation');\n    const fieldValidations = [];\n    const formFieldSelector = `#${$validateableElement.attr('id')}`;\n\n    if (validation.type === 'datechooser') {\n        const dateValidation = buildDateValidation($validateableElement, validation);\n\n        if (dateValidation) {\n            fieldValidations.push(dateValidation);\n        }\n    } else if (validation.required && (validation.type === 'checkboxselect' || validation.type === 'radioselect')) {\n        fieldValidations.push(buildRequiredCheckboxValidation($validateableElement, validation));\n    } else {\n        $validateableElement.find('input, select, textarea').each((index, element) => {\n            const $inputElement = $(element);\n            const tagName = $inputElement.get(0).tagName;\n            const inputName = $inputElement.attr('name');\n            const elementSelector = `${formFieldSelector} ${tagName}[name=\"${inputName}\"]`;\n\n            if (validation.type === 'numberonly') {\n                fieldValidations.push(buildNumberRangeValidation(validation, formFieldSelector));\n            }\n            if (validation.required) {\n                fieldValidations.push(buildRequiredValidation(validation, elementSelector));\n            }\n        });\n    }\n\n    return fieldValidations;\n}\n\n/**\n * Builds the validation model for dynamic forms\n * @param $form\n * @returns {Array}\n */\nexport default function ($form) {\n    let validationsToPerform = [];\n\n    $form.find('[data-validation]').each((index, input) => {\n        validationsToPerform = validationsToPerform.concat(buildValidation($(input)));\n    });\n\n    return validationsToPerform;\n}\n"],"names":["Auth","_PageManager","context","_this","call","formCreateSelector","_proto","prototype","registerLoginValidation","$loginForm","_this2","loginModel","forms","this","loginValidator","nod","submit","add","selector","validate","cb","val","email","errorMessage","useValidEmail","password","enterPass","on","event","performCheck","areAll","preventDefault","registerForgotPasswordValidation","$forgotPasswordForm","_this3","forgotPasswordValidator","registerNewPasswordValidation","newPasswordForm","newPasswordValidator","$","passwordSelector","password2Selector","Validators","setPasswordValidation","passwordRequirements","registerCreateAccountValidator","$createAccountForm","$last","validationModel","validation","createAccountValidator","$stateElement","emailSelector","$emailElement","$passwordElement","$password2Element","stateCountry","err","field","Error","$field","getStatus","remove","is","setStateCountryValidation","cleanUpStateValidation","setEmailValidation","onReady","classifyForm","$newPasswordForm","length","PageManager","$form","validationsToPerform","find","each","index","input","concat","$validateableElement","data","fieldValidations","formFieldSelector","attr","type","dateValidation","$formField","min_date","max_date","invalidMessage","formElementId","minSplit","split","maxSplit","minDate","Date","maxDate","triggeredBy","day","Number","month","year","chosenDate","buildDateValidation","push","required","element","$inputElement","tagName","get","inputName","elementSelector","label","min","max","name","numberVal","buildNumberRangeValidation","buildRequiredValidation","formFieldId","secondarySelector","result","checkbox","checked","buildRequiredCheckboxValidation","buildValidation"],"sourceRoot":""}